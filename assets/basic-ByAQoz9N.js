import{p as C}from"./Product-CmSuYgNW.js";const r={sel:null,addBtn:null,cartDisp:null,sum:null,stockInfo:null,lastSel:null,totalAmt:0,itemCnt:0,bonusPts:0,productList:[]};function g(){const e=document.getElementById("app"),s=document.createElement("div"),o=document.createElement("div"),n=document.createElement("h1"),t=document.createElement("div"),a=document.createElement("div"),d=document.createElement("select"),l=document.createElement("button"),i=document.createElement("div");return t.id="cart-items",a.id="cart-total",d.id="product-select",l.id="add-to-cart",i.id="stock-status",s.className="bg-gray-100 p-8",o.className="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8",n.className="text-2xl font-bold mb-4",a.className="text-xl font-bold my-4",d.className="border rounded p-2 mr-2",l.className="bg-blue-500 text-white px-4 py-2 rounded",i.className="text-sm text-gray-500 mt-2",n.textContent="Ïû•Î∞îÍµ¨Îãà",l.textContent="Ï∂îÍ∞Ä",o.appendChild(n),o.appendChild(t),o.appendChild(a),o.appendChild(d),o.appendChild(l),o.appendChild(i),s.appendChild(o),e.appendChild(s),{cartDisp:t,sum:a,sel:d,addBtn:l,stockInfo:i}}function y(e){const{sel:s,productList:o}=e;s.innerHTML="",o.forEach(function(n){let t=document.createElement("option");t.value=n.id,t.textContent=n.name+" - "+n.val+"Ïõê",n.q===0&&(t.disabled=!0),s.appendChild(t)})}function b(e){const{stockInfo:s,productList:o}=e;let n="";o.forEach(t=>{t.q<5&&(n+=`${t.name}: ${t.q>0?`Ïû¨Í≥† Î∂ÄÏ°± (${t.q}Í∞ú ÎÇ®Ïùå)`:"ÌíàÏ†à"}
`)}),s.textContent=n}const q=e=>{const{totalAmt:s,sum:o}=e;let n=Math.floor(s/1e3),t=document.getElementById("loyalty-points");t||(t=document.createElement("span"),t.id="loyalty-points",t.className="text-blue-500 ml-2",o.appendChild(t)),t.textContent="(Ìè¨Ïù∏Ìä∏: "+n+")"};function h(e){const{cartDisp:s,sum:o,productList:n}=e;let t=0,a=0,d=s.children,l=0;for(let c=0;c<d.length;c++)(function(){let u;for(let m=0;m<n.length;m++)if(n[m].id===d[c].id){u=n[m];break}let f=parseInt(d[c].querySelector("span").textContent.split("x ")[1]),x=u.val*f,p=0;a+=f,l+=x,f>=10&&(u.id==="p1"?p=.1:u.id==="p2"?p=.15:u.id==="p3"?p=.2:u.id==="p4"?p=.05:u.id==="p5"&&(p=.25)),t+=x*(1-p)})();let i=0;if(a>=30){let c=t*.25,u=l-t;c>u?(t=l*(1-.25),i=.25):i=(l-t)/l}else i=(l-t)/l;if(new Date().getDay()===2&&(t*=1-.1,i=Math.max(i,.1)),o.textContent="Ï¥ùÏï°: "+Math.round(t)+"Ïõê",i>0){let c=document.createElement("span");c.className="text-green-500 ml-2",c.textContent="("+(i*100).toFixed(1)+"% Ìï†Ïù∏ Ï†ÅÏö©)",o.appendChild(c)}e.totalAmt=t,e.itemCnt=a,b(e),q(e)}function v(e){const{sel:s,cartDisp:o,productList:n}=e;let t=s.value,a=n.find(function(d){return d.id===t});if(a&&a.q>0){let d=document.getElementById(a.id);if(d){let l=parseInt(d.querySelector("span").textContent.split("x ")[1])+1;l<=a.q?(d.querySelector("span").textContent=a.name+" - "+a.val+"Ïõê x "+l,a.q--):alert("Ïû¨Í≥†Í∞Ä Î∂ÄÏ°±Ìï©ÎãàÎã§.")}else{let l=document.createElement("div");l.id=a.id,l.className="flex justify-between items-center mb-2",l.innerHTML="<span>"+a.name+" - "+a.val+'Ïõê x 1</span><div><button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="'+a.id+'" data-change="-1">-</button><button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="'+a.id+'" data-change="1">+</button><button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="'+a.id+'">ÏÇ≠Ï†ú</button></div>',o.appendChild(l),a.q--}e.lastSel=t,h(e)}}function I(e,s){const{cartDisp:o,productList:n}=s;console.log("üõí cartDisp",o);let t=e.target;if(t.classList.contains("quantity-change")||t.classList.contains("remove-item")){let a=t.dataset.productId,d=document.getElementById(a),l=n.find(function(i){return i.id===a});if(t.classList.contains("quantity-change")){let i=parseInt(t.dataset.change),c=parseInt(d.querySelector("span").textContent.split("x ")[1])+i;c>0&&c<=l.q+parseInt(d.querySelector("span").textContent.split("x ")[1])?(d.querySelector("span").textContent=d.querySelector("span").textContent.split("x ")[0]+"x "+c,l.q-=i):c<=0?(d.remove(),l.q-=i):alert("Ïû¨Í≥†Í∞Ä Î∂ÄÏ°±Ìï©ÎãàÎã§.")}else if(t.classList.contains("remove-item")){let i=parseInt(d.querySelector("span").textContent.split("x ")[1]);l.q+=i,d.remove()}h(s)}}function E(e){const{productList:s,updateSelOpts:o}=e;setTimeout(function(){setInterval(function(){const n=s[Math.floor(Math.random()*s.length)];Math.random()<.3&&n.q>0&&(n.val=Math.round(n.val*.8),alert(`Î≤àÍ∞úÏÑ∏Ïùº! ${n.name}Ïù¥(Í∞Ä) 20% Ìï†Ïù∏ Ï§ëÏûÖÎãàÎã§!`),o(e))},3e4)},Math.random()*1e4)}function L(e){const{productList:s,updateSelOpts:o}=e;setTimeout(()=>{setInterval(()=>{if(e.lastSel){const n=s.find(t=>t.id!==e.lastSel&&t.q>0);n&&(alert(`${n.name}ÏùÄ(Îäî) Ïñ¥Îñ†ÏÑ∏Ïöî? ÏßÄÍ∏à Íµ¨Îß§ÌïòÏãúÎ©¥ 5% Ï∂îÍ∞Ä Ìï†Ïù∏!`),n.val=Math.round(n.val*.95),o(e))}},6e4)},Math.random()*2e4)}function S(){const e=g();r.cartDisp=e.cartDisp,r.sum=e.sum,r.sel=e.sel,r.addBtn=e.addBtn,r.stockInfo=e.stockInfo,r.productList=C,y(r),h(r),r.addBtn.addEventListener("click",()=>v(r)),r.cartDisp.addEventListener("click",s=>I(s,r)),E(r),L(r)}S();
